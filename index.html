<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chill day 小幫手公告</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; padding: 20px; }
        h1 { text-align: center; }
        table { width: 100%; border-collapse: collapse; margin-top: 20px; }
        th, td { border: 1px solid #ccc; padding: 10px; text-align: center; }
        th { background-color: #f4f4f4; }
    </style>
</head>
<body>
    <h1>Chill day 小幫手公告</h1>
    <table id="helperTable">
        <tr>
            <th>日期</th>
            <th>小幫手</th>
        </tr>
    </table>

    <script>
        async function fetchSheetData() {
            const sheetID = "1VscfdBsf6JsFHEtBfAjSyxtYo_JpVzU4jQWydmvvpx8";  // 請替換成你的試算表 ID
            const gid = "0";  // 請替換成你的 Chill day 分頁的 GID
            const url = `https://docs.google.com/spreadsheets/d/${sheetID}/gviz/tq?tqx=out:json&gid=${gid}`;

            try {
                const response = await fetch(url);
                let text = await response.text();
                text = text.match(/\{.*\}/s)[0]; // 確保提取正確的 JSON 內容
                const json = JSON.parse(text);
                const rows = json.table.rows;

                let table = document.getElementById("helperTable");
                let count = 0;
                let today = new Date().toISOString().split('T')[0]; // 取得今天的日期
                
                rows.forEach(row => {
                    let dateText = row.c[0]?.v || "N/A";
                    let helper = row.c[1]?.v || "N/A";
                    let rowDate = new Date(dateText);

                    if (rowDate >= new Date(today) && count < 12) { // 只顯示今天之後的 12 項
                        let rowElement = table.insertRow();
                        let cell1 = rowElement.insertCell(0);
                        let cell2 = rowElement.insertCell(1);
                        cell1.textContent = dateText;
                        cell2.textContent = helper;
                        count++;
                    }
                });
            } catch (error) {
                console.error("讀取 Google Sheets 失敗，請檢查權限與 ID/GID 是否正確", error);
            }
        }

        fetchSheetData();
    </script>
</body>
</html>
